if(!window.J)window.J={_libraries:{},_modules:{},_rLibraryVar:/^\$[\w_]+$/,_rModuleVar:/^__[\w_]+$/,_rModuleName:/^([a-z]+)\.([a-z]+)$/i,library:function(a,b){this._libraries[a]=b},namespace:function(a){this._modules[a]={name:a}},module:function(a,b){var c=this.parseFullName(a),d=c.namespaceName,c=c.moduleName;"undefined"===typeof this._modules[d]&&this.namespace(d);b.fullName=a;b.name=c;this._modules[d][c]=b},parseFullName:function(a){var b=this._rModuleName.exec(a);if(!b)throw'Module name "'+a+
'" is not valid. The module name must be like "namespaceName.moduleName" pattern.';return{namespaceName:b[1],moduleName:b[2]}},init:function(){this._libraries.core=this;this.injectDependencyLibraryToLibarary();this.injectDependencyLibraryToModule();this.injectDependencyModuleToModule()},injectDependencyLibraryToLibarary:function(){var a=this;a.eachLibrary(function(b,c){a.injectLibraryDependency(c)})},injectDependencyLibraryToModule:function(){var a=this;a.eachModule(function(b,c){a.injectLibraryDependency(c)})},
injectDependencyModuleToModule:function(){var a=this;a.eachNamespace(function(b,c){a.eachProperty(c,function(c,e){a.eachProperty(e,function(c){var d=c.substring(2);this[c]=a._modules[b][d]},function(b){return a._rModuleVar.test(b)})},function(a){return"name"!==a})})},injectLibraryDependency:function(a){var b=this;b.eachProperty(a,function(a){var d=a.substring(1);this[a]=b._libraries[d]},function(a){return b._rLibraryVar.test(a)})},eachLibrary:function(a){this.eachProperty(this._libraries,a)},eachNamespace:function(a){this.eachProperty(this._modules,
a)},eachModule:function(a){var b=this;this.eachNamespace(function(c,d){b.eachProperty(d,a,function(a,b){return"name"!==a&&"object"===typeof b})})},eachProperty:function(a,b,c){var d,e,c=c||function(){return!0};for(d in a)a.hasOwnProperty(d)&&c(d,a[d])&&(e=a[d],b.call(a,d,e))},startAll:function(){this.eachModule(function(a,b){"function"===typeof b.init&&b.init()})},start:function(a){a=this.parseFullName(a);module=this._modules[a.namespaceName][a.moduleName];"function"===typeof module.init&&module.init()},
stopAll:function(){this.eachModule(function(a,b){"function"===typeof b.destroy&&b.destroy()})},stop:function(a){a=this.parseFullName(a);module=this._modules[a.namespaceName][a.moduleName];"function"===typeof module.destroy&&module.destroy()}};J.library("util",{guid:function(){return"j"+(1073741824*Math.random()).toString(32).replace(".","")}});
J.library("ps",{$core:null,$util:null,_subscribersMap:{},subscribe:function(a,b){var c=this.$util.guid();this.eachSubscriberMapDepth(a,function(a,e,f,h){h&&(e[c]=b)});return c},eachSubscriberMapDepth:function(a,b){for(var c=this._subscribersMap,d=a.split("."),e=d.length,f,h,g=0;g<e;g++)f=d[g],h=c[f]=c[f]||{},b(f,h,c,g+1===e),c=h},unsubscribe:function(a,b){this.eachSubscriberMapDepth(a,function(a,d,e,f){f&&delete d[b]})},publish:function(a,b){var c=this,d=function(d){c.$core.eachProperty(d,function(c,
d){"function"===typeof d&&d(b,a)})};this.eachSubscriberMapDepth(a,function(a,b,c,g){d(c["*"]);g&&d(b)})},clear:function(a){this.eachSubscriberMapDepth(a,function(a,c,d,e){e&&delete map[a]})}});
J.library("pointcut",{_exprs:{},_rExpr:/^(?:([\w\*]+)\.)?([\w\*]+)\(\)$/,MSG:{INVALID_EXPR:"J.pointcut: invalid expression",ID_REQUIRED:"J.pointcut: id required"},add:function(a,b){if(!a)throw this.MSG.ID_REQUIRED;var c=this._rExpr.exec(b);if(!c)throw this.MSG.INVALID_EXPR;this._exprs[a]={module:c[1]||"*",method:c[2]}},match:function(a,b,c){return(a=this._exprs[a])&&this.matchName(a.module,b)&&this.matchName(a.method,c)?!0:!1},matchName:function(a,b){if("*"===a)return!0;var c="^"+a.replace(/\*/g,
"\\w*")+"$";return RegExp(c).test(b)}});
J.library("advice",{_advices:{},msg:{ADVICE_SHOULD_BE_FUNCTION:"J.advice: advice should be function"},add:function(a,b){if("function"!==typeof b)throw this.msg.ADVICE_SHOULD_BE_FUNCTION;this._advices[a]=b},set:function(a,b,c){var d=this._advices[a],e=this.bind(b[c],b);b[c]=function(){var a=Array.prototype.slice.call(arguments);a.splice(0,0,e);return d.apply(b,a.concat())}},bind:function(a,b,c){var d=Array.prototype.slice,e=d.call(arguments,2);return function(){return a.apply(b,e.concat(d.call(arguments)))}}});
J.library("aop",{$core:null,$advice:null,$pointcut:null,set:function(a,b){var c=this.$core.guid();this.addAdvisor(c,a,b);this.applyAdvisorToModules(c)},addAdvisor:function(a,b,c){this.$pointcut.add(a,b);this.$advice.add(a,c)},applyAdvisorToModules:function(a){var b=this;this.$core.eachModule(function(c,d){b.$core.eachProperty(d,function(c){b.$advice.set(a,d,c)},function(d,f){return"function"===typeof f&&b.$pointcut.match(a,c,d)})})}});J.module("ui.frame",{$util:null,$ps:null,__extension:null,_bActivated:!1,_id:null,init:function(){this._id=this.$util.guid();this.initFrameActivateEvent()},initFrameActivateEvent:function(){this.checkFrameOnMousedown();this.subscribeFrameActivatedMessage();this.subscribeNeedFrameInfoMessage()},checkFrameOnMousedown:function(){var a=this;document.documentElement.addEventListener("mousedown",function(){a.__extension.request("checkFrameExist",a._id)})},subscribeFrameActivatedMessage:function(){var a=
this;this.$ps.subscribe("extension.frameActivated",function(b){a._bActivated=a._id===b})},subscribeNeedFrameInfoMessage:function(){var a=this,b=document.documentElement;this.$ps.subscribe("extension.needFrameInfo",function(){document.body&&a.__extension.request("init",{id:a._id,width:b.offsetWidth,height:b.offsetHeight})})},isActivatedFrame:function(){return this._bActivated}});J.module("ui.extension",{$ps:null,init:function(){var a=this;chrome.extension.onRequest.addListener(function(b,c,d){a.$ps.publish("extension."+b.command,b.data);d({})})},request:function(a,b){chrome.extension.sendRequest({command:a,data:b})}});J.module("ui.markup",{tmpl:function(){var a={};return function c(d,e){var f=!/\W/.test(d)?a[d]=a[d]||c(d):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+d.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return e?f(e):f}}(),_markup:'<div id="endic_ext_header"><div class="endic_ext_endic"><a class="endic_ext_endic_main" href="http://endic.naver.com" target="_blank">\ub124\uc774\ubc84 \uc601\uc5b4\uc0ac\uc804</a></div><% if (result.length > 0) { %><div class="endic_ext_toggle_dic_type"><button nede-cmd="toggleDicType">\ud55c\uc601/\uc601\uc601 \uc804\ud658</button></div><% } %></div><div id="endic_ext_body"><div class="endic_ext_body_wrapper"><% for (var i = 0; i < result.length; i++) { %><% var word = result[i]; %><h3><strong><a href="<%= word.url %>" class="endic_ext_title" target="_blank"><%= word.title %></a></strong><sup class="endic_ext_number"><%= word.number %></sup><span class="endic_ext_phonetic_symbol"><%= word["phonetic_symbol"] %></span><% if (word.pronunciation) { %><button id="endic_ext_audio_btn_<%= i %>" class="endic_ext_play_audio_btn" nede-cmd="playAudio" nede-cmd-value="<%=i %>">Play Audio</button><audio id="endic_ext_audio_<%= i %>" src="<%= word.pronunciation %>"></audio><% } %></h3><% for (var j = 0; j < word.meanings.length; j++) { %><% var meaning = word.meanings[j]; %><div class="endic_ext_meaning"><h4 class="type"><%= meaning.type %></h4><% for (var k = 0; k < meaning.definitions.length; k++) { %><% var definition = meaning.definitions[k]; %><div class="endic_ext_defs"><div class="endic_ext_definition"><%= definition.def %></div><div class="endic_ext_ex_en"><%= definition["ex_en"] %></div><div class="endic_ext_ex_kr"><%= definition["ex_kr"] %></div></div><% } %><% if (meaning.moreDefinition.count > 0) { %><div class="endic_ext_moreDefinition"><a href="<%= meaning.moreDefinition.url %>" target="_blank"><%= meaning.moreDefinition.count %>\uac1c \ub73b \ub354\ubcf4\uae30</a></div><% } %></div><% } %><% } %><% if (result.length === 0) { %><div class="endic_ext_noresult"><span class="endic_ext_keyword">\'<%= query %>\'</span>\uc5d0 \ub300\ud55c \uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.</div><% } %></div></div><div id="endic_ext_footer"><div class="endic_ext_guide_group"><button class="endic_ext_show_shortcut_guide_btn" nede-cmd="showShortcutGuide">\ub2e8\ucd95\ud0a4 \ub3c4\uc6c0\ub9d0</button></div><div id="endic_ext_shortcut_guide"><ul><li><strong>s</strong> : \ud55c\uc601/\uc601\uc601 \uc804\ud658(Switch dictionary)</li><li><strong>a</strong> : \ubc1c\uc74c\ub4e3\uae30(Audio)</li><li><strong>g</strong> : \ud604\uc7ac \ub2e8\uc5b4\uc758 \uc601\uc5b4\uc0ac\uc804 \ud398\uc774\uc9c0\ub85c \uc774\ub3d9(Go to)</li><li><strong>c</strong> : \ub2eb\uae30(Close)</li><li><strong>h</strong> : \ub2e8\ucd95\ud0a4 \ub3c4\uc6c0\ub9d0(Help)</li></ul></div></div>',
print:function(a,b){a.innerHTML=this.tmpl(this._markup,b)}});J.module("ui.layer",{$ps:null,__frame:null,__markup:null,_wrapper:null,init:function(){this.createWrapperElement()},createWrapperElement:function(){var a=document.createElement("div");a.id="endic_ext_wrapper";document.body&&document.body.appendChild(a);this._wrapper=a},open:function(a){if(this.__frame.isActivatedFrame())a&&this.__markup.print(this._wrapper,a),this._wrapper.style.display="block"},close:function(){this._wrapper.style.display="none";this._wrapper.innerHTML=""},isOpened:function(){return"block"===
this._wrapper.style.display},showShortcutGuide:function(){var a=document.getElementById("endic_ext_shortcut_guide");if(a)a.style.display="block"},goToDictionaryPage:function(){var a=document.querySelector("#endic_ext_wrapper .endic_ext_title");a&&window.open(a.getAttribute("href"))}});J.module("ui.audio",{play:function(a){var a=a||0,b=document.getElementById("endic_ext_audio_"+a),a=document.getElementById("endic_ext_audio_btn_"+a);b&&(this.bindAudioEventIfNot(b,a),b.play())},bindAudioEventIfNot:function(a,b){a.getAttribute("binded")||(a.addEventListener("playing",function(){b.className+=" on"},!1),a.addEventListener("ended",function(){b.className=b.className.replace(/on/g,"");a.pause()},!1),a.setAttribute("binded",!0))}});J.module("ui.main",{$ps:null,__layer:null,__audio:null,__extension:null,init:function(){this.initSubscriber()},initSubscriber:function(){this.subscribeMouseEventMessage();this.subscribeShorcutMessage();this.subscribeExtensionMessage()},subscribeMouseEventMessage:function(){var a=this;this.$ps.subscribe("mouseEvent.*",function(b,c){var d=c.split(".")[1];a.__extension.request(d,b)})},subscribeShorcutMessage:function(){var a=this;this.$ps.subscribe("shortcut.*",function(b,c){var d=c.split(".")[1],e=
b.value;"opened"===b.when&&!1===a.__layer.isOpened()||a.__extension.request(d,e)})},subscribeExtensionMessage:function(){var a=this;this.$ps.subscribe("extension.*",function(b,c){var d=c.split(".")[1];if("function"===typeof a[d])a[d](b)})},showResult:function(a){this.__layer.open(a)},close:function(){this.__layer.close()},goToDictionaryPage:function(){this.__layer.goToDictionaryPage()},showShortcutGuide:function(){this.__layer.showShortcutGuide()},playAudio:function(a){this.__audio.play(a)}});J.module("event.mouseEvent",{$ps:null,_wrapper:null,init:function(){this.initClickEventOfWrapper();this.initDoubleClickEvent()},initClickEventOfWrapper:function(){var a=this;document.documentElement.addEventListener("click",function(b){b=b.target;a.isClickedOnWrapper(b)?a.doAction(b):a.$ps.publish("mouseEvent.close")},!1)},isClickedOnWrapper:function(a){var b=this.getWrapper();return b&&b.contains(a)?!0:!1},getWrapper:function(){if(this._wrapper)return this._wrapper;var a=document.getElementById("endic_ext_wrapper");
if(a)this._wrapper=a;return a},doAction:function(a){var b=a.getAttribute("nede-cmd"),a=a.getAttribute("nede-cmd-value");b&&this.$ps.publish("mouseEvent."+b,a)},initDoubleClickEvent:function(){var a=this;document.documentElement.addEventListener("dblclick",function(b){var b=b.target,c=a.getSelectedText();a.isValidTarget(b)&&c&&a.$ps.publish("mouseEvent.search",c)})},isValidTarget:function(a){return/(input|textarea)/i.test(a.tagName)?!1:!0},getSelectedText:function(){return window.getSelection().toString().trim()}});J.module("event.shortcut",{$ps:null,init:function(){this.bindKeyEvent()},bindKeyEvent:function(){var a=this.$ps;document.documentElement.addEventListener("keyup",function(b){switch(b.keyCode){case 67:case 27:a.publish("shortcut.close",{when:"all"});break;case 83:a.publish("shortcut.toggleDicType",{when:"opened"});break;case 71:a.publish("shortcut.goToDictionaryPage",{when:"opened"});break;case 72:a.publish("shortcut.showShortcutGuide",{when:"opened"});break;case 65:a.publish("shortcut.playAudio",
{when:"all"})}})}});J.init();J.startAll();
